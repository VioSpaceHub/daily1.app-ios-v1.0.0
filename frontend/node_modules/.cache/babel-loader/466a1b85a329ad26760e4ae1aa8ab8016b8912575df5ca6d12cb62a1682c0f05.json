{"ast":null,"code":"// Firebase configuration and messaging\nimport { initializeApp, getApps } from 'firebase/app';\nimport { getMessaging, getToken, onMessage } from 'firebase/messaging';\nconst firebaseConfig = {\n  apiKey: process.env.REACT_APP_FIREBASE_API_KEY,\n  authDomain: process.env.REACT_APP_FIREBASE_AUTH_DOMAIN,\n  projectId: process.env.REACT_APP_FIREBASE_PROJECT_ID,\n  storageBucket: process.env.REACT_APP_FIREBASE_STORAGE_BUCKET,\n  messagingSenderId: process.env.REACT_APP_FIREBASE_MESSAGING_SENDER_ID,\n  appId: process.env.REACT_APP_FIREBASE_APP_ID\n};\n\n// Initialize Firebase\nconst getFirebaseApp = () => {\n  return getApps()[0] || initializeApp(firebaseConfig);\n};\n\n// Get messaging instance\nexport const getFirebaseMessaging = () => {\n  const app = getFirebaseApp();\n  return getMessaging(app);\n};\n\n// Request notification permission and get FCM token\nexport const requestNotificationPermission = async () => {\n  try {\n    const permission = await Notification.requestPermission();\n    if (permission !== 'granted') {\n      console.log('Notification permission denied');\n      return null;\n    }\n    const messaging = getFirebaseMessaging();\n    const token = await getToken(messaging, {\n      vapidKey: process.env.REACT_APP_FIREBASE_VAPID_KEY\n    });\n    console.log('FCM Token:', token);\n    return token;\n  } catch (error) {\n    console.error('Error getting notification permission:', error);\n    return null;\n  }\n};\n\n// Listen for foreground messages\nexport const onForegroundMessage = callback => {\n  const messaging = getFirebaseMessaging();\n  return onMessage(messaging, payload => {\n    console.log('Foreground message received:', payload);\n    callback(payload);\n  });\n};\n\n// Register service worker\nexport const registerServiceWorker = async () => {\n  if ('serviceWorker' in navigator) {\n    try {\n      const registration = await navigator.serviceWorker.register('/firebase-messaging-sw.js');\n      console.log('Service Worker registered:', registration);\n      return registration;\n    } catch (error) {\n      console.error('Service Worker registration failed:', error);\n      return null;\n    }\n  }\n  return null;\n};\nexport default getFirebaseApp;","map":{"version":3,"names":["initializeApp","getApps","getMessaging","getToken","onMessage","firebaseConfig","apiKey","process","env","REACT_APP_FIREBASE_API_KEY","authDomain","REACT_APP_FIREBASE_AUTH_DOMAIN","projectId","REACT_APP_FIREBASE_PROJECT_ID","storageBucket","REACT_APP_FIREBASE_STORAGE_BUCKET","messagingSenderId","REACT_APP_FIREBASE_MESSAGING_SENDER_ID","appId","REACT_APP_FIREBASE_APP_ID","getFirebaseApp","getFirebaseMessaging","app","requestNotificationPermission","permission","Notification","requestPermission","console","log","messaging","token","vapidKey","REACT_APP_FIREBASE_VAPID_KEY","error","onForegroundMessage","callback","payload","registerServiceWorker","navigator","registration","serviceWorker","register"],"sources":["/app/frontend/src/lib/firebase.js"],"sourcesContent":["// Firebase configuration and messaging\nimport { initializeApp, getApps } from 'firebase/app';\nimport { getMessaging, getToken, onMessage } from 'firebase/messaging';\n\nconst firebaseConfig = {\n  apiKey: process.env.REACT_APP_FIREBASE_API_KEY,\n  authDomain: process.env.REACT_APP_FIREBASE_AUTH_DOMAIN,\n  projectId: process.env.REACT_APP_FIREBASE_PROJECT_ID,\n  storageBucket: process.env.REACT_APP_FIREBASE_STORAGE_BUCKET,\n  messagingSenderId: process.env.REACT_APP_FIREBASE_MESSAGING_SENDER_ID,\n  appId: process.env.REACT_APP_FIREBASE_APP_ID,\n};\n\n// Initialize Firebase\nconst getFirebaseApp = () => {\n  return getApps()[0] || initializeApp(firebaseConfig);\n};\n\n// Get messaging instance\nexport const getFirebaseMessaging = () => {\n  const app = getFirebaseApp();\n  return getMessaging(app);\n};\n\n// Request notification permission and get FCM token\nexport const requestNotificationPermission = async () => {\n  try {\n    const permission = await Notification.requestPermission();\n    \n    if (permission !== 'granted') {\n      console.log('Notification permission denied');\n      return null;\n    }\n    \n    const messaging = getFirebaseMessaging();\n    const token = await getToken(messaging, {\n      vapidKey: process.env.REACT_APP_FIREBASE_VAPID_KEY,\n    });\n    \n    console.log('FCM Token:', token);\n    return token;\n  } catch (error) {\n    console.error('Error getting notification permission:', error);\n    return null;\n  }\n};\n\n// Listen for foreground messages\nexport const onForegroundMessage = (callback) => {\n  const messaging = getFirebaseMessaging();\n  return onMessage(messaging, (payload) => {\n    console.log('Foreground message received:', payload);\n    callback(payload);\n  });\n};\n\n// Register service worker\nexport const registerServiceWorker = async () => {\n  if ('serviceWorker' in navigator) {\n    try {\n      const registration = await navigator.serviceWorker.register('/firebase-messaging-sw.js');\n      console.log('Service Worker registered:', registration);\n      return registration;\n    } catch (error) {\n      console.error('Service Worker registration failed:', error);\n      return null;\n    }\n  }\n  return null;\n};\n\nexport default getFirebaseApp;\n"],"mappings":"AAAA;AACA,SAASA,aAAa,EAAEC,OAAO,QAAQ,cAAc;AACrD,SAASC,YAAY,EAAEC,QAAQ,EAAEC,SAAS,QAAQ,oBAAoB;AAEtE,MAAMC,cAAc,GAAG;EACrBC,MAAM,EAAEC,OAAO,CAACC,GAAG,CAACC,0BAA0B;EAC9CC,UAAU,EAAEH,OAAO,CAACC,GAAG,CAACG,8BAA8B;EACtDC,SAAS,EAAEL,OAAO,CAACC,GAAG,CAACK,6BAA6B;EACpDC,aAAa,EAAEP,OAAO,CAACC,GAAG,CAACO,iCAAiC;EAC5DC,iBAAiB,EAAET,OAAO,CAACC,GAAG,CAACS,sCAAsC;EACrEC,KAAK,EAAEX,OAAO,CAACC,GAAG,CAACW;AACrB,CAAC;;AAED;AACA,MAAMC,cAAc,GAAGA,CAAA,KAAM;EAC3B,OAAOnB,OAAO,CAAC,CAAC,CAAC,CAAC,CAAC,IAAID,aAAa,CAACK,cAAc,CAAC;AACtD,CAAC;;AAED;AACA,OAAO,MAAMgB,oBAAoB,GAAGA,CAAA,KAAM;EACxC,MAAMC,GAAG,GAAGF,cAAc,CAAC,CAAC;EAC5B,OAAOlB,YAAY,CAACoB,GAAG,CAAC;AAC1B,CAAC;;AAED;AACA,OAAO,MAAMC,6BAA6B,GAAG,MAAAA,CAAA,KAAY;EACvD,IAAI;IACF,MAAMC,UAAU,GAAG,MAAMC,YAAY,CAACC,iBAAiB,CAAC,CAAC;IAEzD,IAAIF,UAAU,KAAK,SAAS,EAAE;MAC5BG,OAAO,CAACC,GAAG,CAAC,gCAAgC,CAAC;MAC7C,OAAO,IAAI;IACb;IAEA,MAAMC,SAAS,GAAGR,oBAAoB,CAAC,CAAC;IACxC,MAAMS,KAAK,GAAG,MAAM3B,QAAQ,CAAC0B,SAAS,EAAE;MACtCE,QAAQ,EAAExB,OAAO,CAACC,GAAG,CAACwB;IACxB,CAAC,CAAC;IAEFL,OAAO,CAACC,GAAG,CAAC,YAAY,EAAEE,KAAK,CAAC;IAChC,OAAOA,KAAK;EACd,CAAC,CAAC,OAAOG,KAAK,EAAE;IACdN,OAAO,CAACM,KAAK,CAAC,wCAAwC,EAAEA,KAAK,CAAC;IAC9D,OAAO,IAAI;EACb;AACF,CAAC;;AAED;AACA,OAAO,MAAMC,mBAAmB,GAAIC,QAAQ,IAAK;EAC/C,MAAMN,SAAS,GAAGR,oBAAoB,CAAC,CAAC;EACxC,OAAOjB,SAAS,CAACyB,SAAS,EAAGO,OAAO,IAAK;IACvCT,OAAO,CAACC,GAAG,CAAC,8BAA8B,EAAEQ,OAAO,CAAC;IACpDD,QAAQ,CAACC,OAAO,CAAC;EACnB,CAAC,CAAC;AACJ,CAAC;;AAED;AACA,OAAO,MAAMC,qBAAqB,GAAG,MAAAA,CAAA,KAAY;EAC/C,IAAI,eAAe,IAAIC,SAAS,EAAE;IAChC,IAAI;MACF,MAAMC,YAAY,GAAG,MAAMD,SAAS,CAACE,aAAa,CAACC,QAAQ,CAAC,2BAA2B,CAAC;MACxFd,OAAO,CAACC,GAAG,CAAC,4BAA4B,EAAEW,YAAY,CAAC;MACvD,OAAOA,YAAY;IACrB,CAAC,CAAC,OAAON,KAAK,EAAE;MACdN,OAAO,CAACM,KAAK,CAAC,qCAAqC,EAAEA,KAAK,CAAC;MAC3D,OAAO,IAAI;IACb;EACF;EACA,OAAO,IAAI;AACb,CAAC;AAED,eAAeb,cAAc","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}